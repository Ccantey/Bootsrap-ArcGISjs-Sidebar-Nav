<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Chris Cantey, GIS Developer">
	<link rel="shortcut icon" href="../../assets/ico/favicon.ico">
	<!--Facebook Share customization open graph meta tags-->
	<meta property="og:image" content="http://geo-odyssey.com/links/Public/images/TeriBertinWR.png"/>
	<meta property="og:title" content="Wisconsin Rapids Maps"/>
	<meta property="og:description" content="Citizen Services maps for the City of Wisconsin Rapids."/>
	<meta property="og:url" content="http://geo-odyssey.com/links/Public/"/>
    

    <title>GIS | Wisc Rapids</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">
	<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
	<!--JavaScript API & Stylesheets-->
	<script src="http://js.arcgis.com/3.9/"></script>
    <link href="http://js.arcgis.com/3.9/js/esri/css/esri.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="css/dashboard.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	
	<script>	
	  var initExtent;
	  var basemap, utilityMap, maxExtent;
	  var overlayLayer;
	  var aerialLayer;
	  var nonLegendLayers;
	  var legend = null;
	  var legendLayers = [];
      var map = null;
	  var globalMapLayers = [];
	  var geocoder;
	  var gpsid;
	  var graphic;
		
		require(["dojo/on", 
			  "esri/domUtils",
			  "esri/map",
			  "esri/request",		
			  "esri/dijit/Legend",
			  "esri/layers/ArcGISDynamicMapServiceLayer",	
			  "esri/dijit/Geocoder"			  ,
			  "esri/geometry/Extent",
			  "esri/SpatialReference",
			  "dojo/domReady!"],
		function(on, domUtils, Map, esriRequest, Legend, ArcGISDynamicMapServiceLayer, Geocoder, Extent, SpatialReference){	
		
		  var mapServiceURL = "https://gis.wirapids.org/arcgis/rest/services/PublicBasemap/MapServer";
		  
		  //initExtent = new Extent({xmin:-1.0016607077900654E7,ymin:5514621.059962168,xmax:-9982809.986253398,ymax:5538802.983481816,spatialReference:{wkid:102100}})
		  map = new Map("map", {
			center: [-89.83, 44.39],
			zoom: 14,
			basemap:'satellite'
			
		  }); 
		var layersRequest = esriRequest({
			url: mapServiceURL,
			content: { f: "json" },
			handleAs: "json",
			callbackParamName: "callback"
		  });
		  layersRequest.then(
			function(response) {
			  //console.log("Success: ", response.layers);
			  globalMapLayers = response.layers;
		  }, function(error) {
			  console.log("Error: ", error.message);
		  });		    
		 
		  
		  //Add dynamic map 
		  overlayLayer = new ArcGISDynamicMapServiceLayer(mapServiceURL, {id:"Basemap"});
		  overlayLayer.setImageFormat("png32");
		  overlayLayer.setVisibleLayers([3,4,11]);
		  //overlayLayer.opacity = 0.7;
		  map.addLayer(overlayLayer);
          //console.log(overlayLayer);
		  on(map, "update-end", function(){
		    domUtils.hide(loading);
			map.disableDoubleClickZoom();
		  });
          on(map, "update-start", function(){
		    domUtils.show(loading);
		  });
		  //create geocoder
		  geocoder = new Geocoder({
		     autoComplete: true,
			 maxLocations: 10,
			 suffix: " Wisconsin Rapids, WI",
		     map:map
		  }, "search");
		  geocoder.startup();
		  
          //legendLayers.push({ layer: map, title: " ",hideLayers:[0,1,2,3,27]});
	      legendLayers.push({ layer: overlayLayer, title: "Legend ",hideLayers:[3,4,11]});
		  console.log(legendLayers);
		  legend = new Legend({
            map:map,
            layerInfos:legendLayers
          },"legendDiv");
		  legend.startup();

  
		   
	  });
	</script>
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
		
          <button id="bars"type="button" class="navbar-toggle" data-toggle="offcanvas" data-target=".sidebar-nav">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
		  
		  <button id="FB"type="button" class="btn-lg navbar-toggle" >		
		    <span class="btn btn-default btn-xs" target="_blank" title="On Facebook" href="http://www.facebook.com/sharer.php?u=http%3A%2F%2Fgeo-odyssey.com/links/Public/index.html">
                <i class="fa fa-facebook fa-lg fb"></i></span> 
		  </button>
		  
		  <button id="TW"type="button" class="btn-lg navbar-toggle" >		
		    <span class="btn btn-default btn-xs" target="_blank" title="On Twitter" href="http://twitter.com/share?url=http%3A%2F%2Fgeo-odyssey.com/links/Public/index.html
				                                                                           &text=Citizen%20Service%20Maps%20from%20the%20City%20of%20Wisconsin%20Rapids">
				<i class="fa fa-twitter fa-lg tw"></i></span> 
		  </button>
		  
				
				
		  <button id="gps"type="button" class="btn-lg navbar-toggle" >		
		    <span class="glyphicon glyphicon-screenshot"></span> 
		  </button>
          <a id="cityviewer" class="navbar-brand" href="http://www.wirapids.org">Wisconsin Rapids</a><a class="navbar-brand" href="http://www.wirapids.org" target="blank" id="cityviewerSMALL">Wisc Rapids</a>
        </div>
		<!--search-->
        <div class="navbar-collapse collapse">
		
           <ul class="nav navbar-nav navbar-right" id="about">
            <li><a href="#">about</a></li>

			<li>
			    <a class="btn btn-default btn-xs" target="_blank" title="On Facebook" href="http://www.facebook.com/sharer.php?u=http%3A%2F%2Fgeo-odyssey.com/links/Public/index.html">
                <i class="fa fa-facebook fa-lg fb"></i></a>
			</li>
			<li>
				<a class="btn btn-default btn-xs" target="_blank" title="On Twitter" href="http://twitter.com/share?url=http%3A%2F%2Fgeo-odyssey.com/links/Public/index.html
				                                                                           &text=Citizen%20Service%20Maps%20from%20the%20City%20of%20Wisconsin%20Rapids">
				<i class="fa fa-twitter fa-lg tw"></i></a>
			</li>
          </ul> 
          <form class="navbar-form navbar-right">
            <div id ="search"></div>
          </form>

        </div>
		
      </div>
    </div>

    <div class="container-fluid">
      <div class="row row-offcanvas row-offcanvas-left">
	   <!--sidebar-->
        <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar" role="navigation">
          <ul class="nav">
            <li class="overlayLayer"><a href="#">Refuse</a></li>
            <li class="overlayLayer"><a href="#">Developable City Property</a></li>
            <li class="overlayLayer"><a href="#">Alderman Districts</a></li>
			<li class="overlayLayer"><a href="#">Parks & Trails</a></li>
            <li class="overlayLayer"><a href="#">Zoning Districts</a></li>
            <li class="overlayLayer"><a href="#">Extra</a></li>
          </ul>

		  
		  <!--add legend here-->
		  <section class="legend-items" id="legendDiv">

           </section>
		  <!--footer-->
		  <img class="foot" src="images/watermark2.png" alt="Rapids Logo">
        </div>
        <div id="map">
          <img id="loading" src="images/loading.gif" style="position:absolute;top:50%;left:50%;z-index:1111;width:32px;height:32px;" >
        </div>
      </div>
    </div>



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
	
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
	<script src="js/app.js"></script>
  </body>
</html>
